const mq = require('message-queue');
const RSMQPromise = require('rsmq-promise');
const logger = require('logger');
const expect = require('chai').expect;

const rsmq = new RSMQPromise({
    host: "127.0.0.1", 
    port: 6379
});

describe('message-queue.js', () => {
    it ('should create an artist details job', function(done) {
        let artistId = "fakeid";
        let userToken = "fakeToken";
        mq.createArtistDetailsJob(artistId, userToken)
            .then(() => mq.consumeArtistDetailsJob())
            .then((message) => {
                expect(message.artist_id).to.be.equal(artistId);
                expect(message.token).to.be.equal(userToken);
                done();
            });
    });
});